/scratch/ba63/miniconda3/envs/gender_rewriting/lib/python3.7/site-packages/mxnet/optimizer/optimizer.py:167: UserWarning: WARNING: New optimizer gluonnlp.optimizer.lamb.LAMB is overriding existing optimizer mxnet.optimizer.optimizer.LAMB
  Optimizer.opt_registry[name].__name__))
INFO:__main__:Namespace(analyze_errors=True, beam_width=10, bert_model='/scratch/ba63/mlm_lm/bert-base-arabic-camelbert-msa-mlm', cbr_backoff=False, cbr_ngram=2, data_dir='/scratch/ba63/Arabic-Parallel-Gender-Corpus/Arabic-parallel-gender-corpus-v-2.0/data/new_token_data/', error_analysis_dir='logs/paper_results_with_mlm_ft_final/multi_user_with_clitics/error_analysis/NeuralR', first_person_only=False, inference_mode='dev', morph_db='/scratch/ba63/calima_databases/calima-msa/calima-msa-s31_0.4.2.utf8.db.copy-mod', output_dir='logs/paper_results_with_mlm_ft_final/multi_user_with_clitics/rewriting/NeuralR', pick_top_mle=False, rbr_top_rule=False, rbr_top_tgt_rule=False, reduce_cbr_noise=False, seq2seq_model_path='neural_rewriter/saved_models', src_bert_tags_dir='/scratch/ba63/gender-rewriting/gender-id/CAMeLBERT_MSA/multi_user_with_clitics/models/dev_predictions.txt', top_n_best=5, use_cbr=False, use_data_augmentation=False, use_gpu=True, use_morph=False, use_rbr=False, use_seq2seq=True)
WARNING:root:Model '/scratch/ba63/mlm_lm/bert-base-arabic-camelbert-msa-mlm' not recognized as an MXNet model; treating as PyTorch model
WARNING:root:Created scorer of class 'MLMScorerPT'.
INFO:__main__:

INFO:__main__:######## MM Rewriting ########
INFO:__main__:

INFO:__main__:There are 57604 Training Examples
INFO:__main__:There are 6648 Dev Examples
INFO:__main__:Loading the pretrained neural rewriter model
INFO:rewriter:CBR triggers: 0
INFO:rewriter:Morph triggers: 0
INFO:rewriter:RBR triggers: 0
INFO:rewriter:Neural triggers: 2296
INFO:rewriter:Regular passes: 46961
INFO:rewriter:Selection triggers: 1787
INFO:rewriter:===========================
INFO:rewriter:CBR OOV: 0
INFO:rewriter:Morph OOV: 0
INFO:rewriter:RBR OOV: 0
INFO:rewriter:===========================
INFO:root:38700 sents of 265625, batch 20 of 136
INFO:root:78700 sents of 265625, batch 40 of 136
INFO:root:117500 sents of 265625, batch 60 of 136
INFO:root:157500 sents of 265625, batch 80 of 136
INFO:root:195625 sents of 265625, batch 100 of 136
INFO:root:235625 sents of 265625, batch 120 of 136
INFO:root:38348 sents of 562500, batch 20 of 284
INFO:root:78080 sents of 562500, batch 40 of 284
INFO:root:118080 sents of 562500, batch 60 of 284
INFO:root:158080 sents of 562500, batch 80 of 284
INFO:root:196875 sents of 562500, batch 100 of 284
INFO:root:236875 sents of 562500, batch 120 of 284
INFO:root:276875 sents of 562500, batch 140 of 284
INFO:root:316875 sents of 562500, batch 160 of 284
INFO:root:356875 sents of 562500, batch 180 of 284
INFO:root:395815 sents of 562500, batch 200 of 284
INFO:root:435815 sents of 562500, batch 220 of 284
INFO:root:475815 sents of 562500, batch 240 of 284
INFO:root:515800 sents of 562500, batch 260 of 284
INFO:root:555372 sents of 562500, batch 280 of 284
INFO:root:38448 sents of 97500, batch 20 of 52
INFO:root:76368 sents of 97500, batch 40 of 52
INFO:root:34952 sents of 51250, batch 20 of 30
INFO:root:37341 sents of 79375, batch 20 of 44
INFO:root:73951 sents of 79375, batch 40 of 44
INFO:__main__:

INFO:__main__:######## FM Rewriting ########
INFO:__main__:

INFO:__main__:There are 57604 Training Examples
INFO:__main__:There are 6648 Dev Examples
INFO:__main__:Loading the pretrained neural rewriter model
INFO:rewriter:CBR triggers: 0
INFO:rewriter:Morph triggers: 0
INFO:rewriter:RBR triggers: 0
INFO:rewriter:Neural triggers: 2304
INFO:rewriter:Regular passes: 46953
INFO:rewriter:Selection triggers: 1798
INFO:rewriter:===========================
INFO:rewriter:CBR OOV: 0
INFO:rewriter:Morph OOV: 0
INFO:rewriter:RBR OOV: 0
INFO:rewriter:===========================
INFO:root:38700 sents of 265625, batch 20 of 136
INFO:root:78700 sents of 265625, batch 40 of 136
INFO:root:117500 sents of 265625, batch 60 of 136
INFO:root:157500 sents of 265625, batch 80 of 136
INFO:root:195625 sents of 265625, batch 100 of 136
INFO:root:235625 sents of 265625, batch 120 of 136
INFO:root:38348 sents of 562500, batch 20 of 284
INFO:root:78080 sents of 562500, batch 40 of 284
INFO:root:118080 sents of 562500, batch 60 of 284
INFO:root:158080 sents of 562500, batch 80 of 284
INFO:root:196875 sents of 562500, batch 100 of 284
INFO:root:236875 sents of 562500, batch 120 of 284
INFO:root:276875 sents of 562500, batch 140 of 284
INFO:root:316875 sents of 562500, batch 160 of 284
INFO:root:356875 sents of 562500, batch 180 of 284
INFO:root:395815 sents of 562500, batch 200 of 284
INFO:root:435815 sents of 562500, batch 220 of 284
INFO:root:475815 sents of 562500, batch 240 of 284
INFO:root:515800 sents of 562500, batch 260 of 284
INFO:root:555372 sents of 562500, batch 280 of 284
INFO:root:38448 sents of 97500, batch 20 of 52
INFO:root:76368 sents of 97500, batch 40 of 52
INFO:root:34952 sents of 51250, batch 20 of 30
INFO:root:37341 sents of 79375, batch 20 of 44
INFO:root:73951 sents of 79375, batch 40 of 44
INFO:__main__:

INFO:__main__:######## MF Rewriting ########
INFO:__main__:

INFO:__main__:There are 57604 Training Examples
INFO:__main__:There are 6648 Dev Examples
INFO:__main__:Loading the pretrained neural rewriter model
INFO:rewriter:CBR triggers: 0
INFO:rewriter:Morph triggers: 0
INFO:rewriter:RBR triggers: 0
INFO:rewriter:Neural triggers: 2294
INFO:rewriter:Regular passes: 46963
INFO:rewriter:Selection triggers: 1814
INFO:rewriter:===========================
INFO:rewriter:CBR OOV: 0
INFO:rewriter:Morph OOV: 0
INFO:rewriter:RBR OOV: 0
INFO:rewriter:===========================
INFO:root:36869 sents of 306250, batch 20 of 158
INFO:root:76869 sents of 306250, batch 40 of 158
INFO:root:115490 sents of 306250, batch 60 of 158
INFO:root:155490 sents of 306250, batch 80 of 158
INFO:root:195410 sents of 306250, batch 100 of 158
INFO:root:235410 sents of 306250, batch 120 of 158
INFO:root:273966 sents of 306250, batch 140 of 158
INFO:root:34601 sents of 102500, batch 20 of 57
INFO:root:73126 sents of 102500, batch 40 of 57
INFO:root:36521 sents of 85000, batch 20 of 47
INFO:root:76416 sents of 85000, batch 40 of 47
/scratch/ba63/miniconda3/envs/gender_rewriting/lib/python3.7/site-packages/gluonnlp/data/sampler.py:354: UserWarning: Some buckets are empty and will be removed. Unused bucket keys=[10]
  str(unused_bucket_keys))
INFO:__main__:

INFO:__main__:######## FF Rewriting ########
INFO:__main__:

INFO:__main__:There are 57604 Training Examples
INFO:__main__:There are 6648 Dev Examples
INFO:__main__:Loading the pretrained neural rewriter model
INFO:rewriter:CBR triggers: 0
INFO:rewriter:Morph triggers: 0
INFO:rewriter:RBR triggers: 0
INFO:rewriter:Neural triggers: 2302
INFO:rewriter:Regular passes: 46955
INFO:rewriter:Selection triggers: 1818
INFO:rewriter:===========================
INFO:rewriter:CBR OOV: 0
INFO:rewriter:Morph OOV: 0
INFO:rewriter:RBR OOV: 0
INFO:rewriter:===========================
INFO:root:36869 sents of 306250, batch 20 of 158
INFO:root:76869 sents of 306250, batch 40 of 158
INFO:root:115490 sents of 306250, batch 60 of 158
INFO:root:155490 sents of 306250, batch 80 of 158
INFO:root:195410 sents of 306250, batch 100 of 158
INFO:root:235410 sents of 306250, batch 120 of 158
INFO:root:273966 sents of 306250, batch 140 of 158
INFO:root:34601 sents of 102500, batch 20 of 57
INFO:root:73126 sents of 102500, batch 40 of 57
INFO:root:36521 sents of 85000, batch 20 of 47
INFO:root:76416 sents of 85000, batch 40 of 47
